---
sidebar_position: 11
title: "🔎 检索增强生成 (RAG)"
---

::::warning

如果您使用的是 **Ollama**，请注意它**默认将上下文长度设置为 2048 个令牌**。这意味着检索到的数据可能**根本不会被使用**，因为它不适合可用的上下文窗口。要提高**检索增强生成 (RAG) 性能**，您应该在 Ollama 模型设置中**增加上下文长度**至**8192+ 令牌**。  

::::


检索增强生成 (RAG) 是一种前沿技术，通过整合来自多种来源的上下文来增强聊天机器人的对话能力。它通过从广泛的来源（如本地和远程文档、网页内容，甚至包括 YouTube 视频等多媒体来源）检索相关信息来工作。检索到的文本随后与预定义的 RAG 模板结合，并添加到用户提示的前面，提供更加明智和上下文相关的响应。

RAG 的主要优势之一是它能够访问和整合来自各种来源的信息，使其成为复杂对话场景的理想解决方案。例如，当用户提出与特定文档或网页相关的问题时，RAG 可以从该来源检索并整合相关信息到聊天响应中。RAG 还可以从 YouTube 视频等多媒体来源检索和整合信息。通过分析这些视频的转录或字幕，RAG 可以提取相关信息并将其整合到聊天响应中。



## 本地和远程 RAG 集成

必须首先通过工作区区域的文档部分上传本地文档，才能使用查询前的 `#` 符号访问它们。点击出现在聊天框上方的格式化 URL。选择后，`发送消息` 上方会出现一个文档图标，表示成功检索。

您还可以通过以 `#` 开始提示，后跟 URL，将文档加载到工作区区域并访问它们。这可以帮助将网页内容直接整合到您的对话中。

## RAG 的网络搜索

对于网页内容集成，在聊天中以 `#` 开始查询，后跟目标 URL。点击出现在聊天框上方的格式化 URL。选择后，`发送消息` 上方会出现一个文档图标，表示成功检索。如果可能，Open WebUI 会获取并解析来自 URL 的信息。

::::tip
网页通常包含额外信息，如导航和页脚。为获得更好的结果，请链接到页面的原始或阅读友好版本。
::::

## RAG 模板自定义

从 `管理面板` > `设置` > `文档` 菜单自定义 RAG 模板。

## RAG 嵌入支持

直接在 `管理面板` > `设置` > `文档` 菜单中更改 RAG 嵌入模型。此功能支持 Ollama 和 OpenAI 模型，使您能够根据需求增强文档处理。

## RAG 功能中的引用

RAG 功能允许用户通过添加引用点轻松跟踪提供给 LLM 的文档上下文。这确保了在聊天中使用外部来源的透明度和责任性。

## 增强的 RAG 管道

我们的 RAG 嵌入功能的可切换混合搜索子功能通过 `BM25` 增强 RAG 功能，由 `CrossEncoder` 提供重新排名，并具有可配置的相关性分数阈值。这为您的特定用例提供了更精确和定制的 RAG 体验。

## YouTube RAG 管道

专用于通过视频 URL 总结 YouTube 视频的 RAG 管道，实现与视频转录的流畅交互。这一创新功能允许您将视频内容整合到聊天中，进一步丰富您的对话体验。

## 文档解析

各种解析器从本地和远程文档中提取内容。更多信息，请参见 [`get_loader`](https://github.com/open-webui/open-webui/blob/2fa94956f4e500bf5c42263124c758d8613ee05e/backend/apps/rag/main.py#L328) 函数。

## Google Drive 集成

当与启用了 Google Picker API 和 Google Drive API 的 Google Cloud 项目配对时，此功能允许用户直接从聊天界面访问他们的 Drive 文件，并上传文档、幻灯片、表格等，并将它们作为上下文上传到您的聊天中。可以在 `管理面板` > `设置` > `文档` 菜单中启用。必须设置 [`GOOGLE_DRIVE_API_KEY 和 GOOGLE_DRIVE_CLIENT_ID`](https://github.com/open-webui/docs/blob/main/docs/getting-started/env-configuration.md) 环境变量才能使用。

### 详细说明
1. 创建一个 OAuth 2.0 客户端，并将授权的 JavaScript 来源和授权的重定向 URI 都配置为您用于访问 Open-WebUI 实例的 URL（如果有的话，包括端口）。
2. 记下与该 OAuth 客户端关联的客户端 ID。
3. 确保为您的项目启用 Google Drive API 和 Google Picker API。
4. 还要将您的应用（项目）设置为测试模式，并将您的 Google Drive 电子邮件添加到用户列表中。
5. 将权限范围设置为包括这些 API 提供的所有内容。由于应用程序处于测试模式，Google 不需要验证即可允许应用程序访问有限测试用户的数据。
6. 转到 Google Picker API 页面，然后点击创建凭据按钮。
7. 创建一个 API 密钥，在应用程序限制下选择网站。然后添加您的 Open-WebUI 实例的 URL，与步骤 1 中的授权 JavaScript 来源和授权重定向 URI 设置相同。
8. 在 API 密钥上设置 API 限制，使其只能访问 Google Drive API 和 Google Picker API。
9. 设置环境变量 `GOOGLE_DRIVE_CLIENT_ID` 为步骤 2 中 OAuth 客户端的客户端 ID。
10. 设置环境变量 `GOOGLE_DRIVE_API_KEY` 为步骤 7 中设置的 API 密钥值（不是步骤 2 中的 OAuth 客户端密钥）。
11. 设置 `GOOGLE_REDIRECT_URI` 为您的 Open-WebUI 实例的 URL（如果有的话，包括端口）。
12. 然后使用这三个环境变量重新启动您的 Open-WebUI 实例。
13. 之后，确保在 `管理面板` < `设置` < `文档` < `Google Drive` 下启用了 Google Drive。